\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage{algorithm}
\usepackage{tikz}
\usepackage{caption}

\title{The Course Registration Problem}
\author{Auden Woolfson}

\newcommand{\caps}{\operatorname{CAP}}
\newcommand{\sched}{\operatorname{SCHED}}
\newcommand{\ranks}{\operatorname{RANKS}}
\newcommand{\score}{\operatorname{SCORE}}

\begin{document}

\maketitle
\section{Introduction}
\setlength\parindent{0pt}\par
The initial idea of the course registration problem came from the stable matching problem. The stable matching problem is often conceptualized as a group of men and a group of women with equal cardinality, where the ultimate goal is to create a one to one matching where each agent has a partner of the opposite sex. Many of the principles pertinent to the stable matching problem remain with respect to the hospital-residents problem, which attempts to pair hospitals with medical students for residency. The key difference is that hospitals can pair with multiple residents, the exact number based on a variable capacity. Many to many stable matching is the problem where both sides can pair to multiple agents on the other side, which remains quite similar to the other two problems.\\\par

The course registration problem is fundamentally an extension of the many to many stable matching problem, modeling college students trying to register for the courses they want for the semester. Each course has a ranking of students that can include ties. This is because each student is ranked based on a priority function that can produce the same result for multiple students. This introduces types of stability, super, strong, and weak. For the purpose of this problem weak stability is completely adequate, and this goal will not change the nature of the problem greatly.\\\par

Another variation between the many to many stable matching problem and the course registration problem is that students have limited course rankings. This is because there are many courses that a student could prefer not be enrolled in any course than to be enrolled in (for instance, an English major in an advanced chemistry course). In most cases students would only be willing to take a small subset of the courses offered.\\\par

% unconfirmed

This difference does not impact the problem at all based on a simple reduction. A number of placeholder of "null" courses can be added to the course listings, each with capacity equal to the total number of registering students. Each of these courses will have a constant priority function for students, so all students are a tie. On each students preference list of courses each of the null courses will be placed in a set and constant order after the courses the student actually desires. There will always be enough space for students in these courses, and since all students are tied and prefer the courses in the same order it cannot result in a strong or super instability for a student to be enrolled in one of them. After the null courses on the preference list, students will have each of the other courses offered in any order completing the preference list, so that no stable matching will include students enrolled in them who do not desire to be. The version of the problem analyzed below has students with complete course rankings.\\\par

The final major difference and perhaps the greatest is the introduction of scheduling conflicts. Students may desire to be in enrolled in a course that has a scheduling conflict with another course that they would like to take if they are unable to enroll in the better one. This turns the course registration problem into a graph problem, where the offered courses represent vertices and an edge is placed between each pair of courses with a scheduling conflict. Students may only enroll in.\\\par

\section{Problem Definition}
\setlength\parindent{0pt}\par
Let <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C}}" /> be a set of <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{m}}" /> course sections, and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S}}" /> be a set of <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{n}}" /> students\\\par
For each section <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%20%5Cin%20C}}" /> let <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Ccaps_c}}" /> denote the capacity of the section, let <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Csched_c}}" /> denote the list of times and days on which <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> will be held\\\par
Let each <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%20%5Cin%20S}}" /> have a ranking <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" /> in order from most preferred to least preferred course by <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" />, where <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%7C%5Cranks_s%7C%20%3D%20%7CC%7C}}" />, and there are no duplicates in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" /> \\\par
Let <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{L}}" /> be the maximum amount of courses a student can register for\\\par
For each possible pairing of some <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%20%5Cin%20S}}" /> and some <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%20%5Cin%20C}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%28s%2C%20c%29}}" />, let there be a ranking score denoted by <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cscore_%7Bs%2C%20c%7D}}" />. This number is meant to represent the priority level of the student to get into that course, as opposed to the preference of the student. \\\par
Let <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C_s}}" /> denote the course sections some <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%20%5Cin%20S}}" /> is matched to and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c}}" /> denote the students some <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%20%5Cin%20C}}" /> is matched to in an <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S%2C%20C}}" /> matching\\\par
Let an <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S%2CC}}" /> matching be considered valid if for each <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%20%5Cin%20S}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%7CS_c%7C%20%5Cle%20L}}" />, for each <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%20%5Cin%20C}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%7CS_c%7C%20%5Cle%20%5Ccaps_c}}" />, and for each <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%20%5Cin%20S}}" />, there exists no pair in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C_s}}" /> with overlapping times (<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Csched_c}}" />)\\\par 

% work on this, stability is weird

Let an <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S%2C%20C}}" /> matching be considered stable if there are no rogue pairs. A rogue pair refers to a student that would prefer to be in a course that they are not enrolled in over one they have been enrolled in, where the pair of that student and course has a higher ranking score than some student enrolled in that course section. A rogue pair also refers to any student that would prefer to be in a section that they have not been enrolled in and still has space for more students, or a section with capacity for more students where some student would prefer to be in that section over one they have been enrolled in. Finally a rogue pair is any student and course section\\\par
Let a rogue pair be some <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27%20%5Cin%20S}}" /> and some <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27%20%5Cin%20%5Cranks_%7Bs%27%7D}}" /> in an <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S%2C%20C}}" /> matching where <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%7CC_%7Bs%27%7D%7C%20%5Cle%20L}}" />, or if there exists some <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%20%5Cin%20C_%7Bs%27%7D}}" /> that is lower ranked than <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27}}" /> in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{G_%7Bs%27%7D}}" /> (or does not exist in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{G_%7Bs%27%7D}}" />) that can be removed from <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C_%7Bs%27%7D}}" /> to meet the previous condition. The rogue pair also requires that <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%7CS_%7Bc%27%7D%7C%20%3C%20%5Ccaps_%7Bc%27%7D}}" /> or there exists a student <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%20%5Cin%20S_%7Bc%27%7D}}" /> where <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cscore_%7Bs%2C%20c%27%7D%20%3C%20%5Cscore_%7Bs%27%2C%20c%27%7D}}" />. However, pairs that meet these conditions are not considered rogue if there is a time conflict between some <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%20%5Cin%20C_s%27}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27}}" /> where <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> is ranked more highly in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s%27}}" /> than <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27}}" />\\\par

The goal is, given <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C}}" />, produces a valid and weakly stable matching <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{X}}" />.
\\\\

\section{Gale-Shapley Style Approach}

\begin{algorithm}
\caption{Assign students to sections using a Gale-Shapley style approach}
\begin{algorithmic}[1]
\Procedure{Assign Students}{<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C}}" />}
\State <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{freeStudents%20%5Cgets%20S}}" />
\While{<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{freeStudents}}" /> is not empty}
\State <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%20%5Cgets%20freeStudents%5B-1%5D}}" />
\While{<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> has not proposed to some section in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" />\par
\hskip\algorithmicindent that has no time conflict with any section in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C_s}}" />\par 
\hskip\algorithmicindent and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%7CS_c%7C%20%3C%20L}}" />}
\State <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%20%5Cgets}}" /> first section in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" /> that <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> has not proposed to\par
\hskip\algorithmicindent\hskip\algorithmicindent and does not conflict with any section in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C_s}}" />
\State mark <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> as proposed to in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" />
\If{<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%7CS_c%7C%20%3C%20%5Ccaps_c}}" />}
\State Append <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c}}" />
\ElsIf{<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cscore_%7Bs%2Cc%7D%20%3E%20%28%5Cscore%7Bs%27%2Cc%7D%20%7C%20s%27%20%5Cin%20S_c}}" />)}
\State <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27%20%5Cgets}}" /> the student in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c}}" />\par
\hskip\algorithmicindent\hskip\algorithmicindent\hskip\algorithmicindent where <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cscore_%7Bs%27%2Cc%7D}}" /> is the lowest of any possible <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27%20%5Cin%20S_c}}" />
\State remove <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27}}" /> from <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" />
\State Append <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c}}" />
\If{<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27}}" /> is not in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{freeStudents}}" />}
\State Append <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27}}" /> to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{freeStudents}}" />
\State \textbf{break}
\EndIf
\EndIf
\EndWhile
\If{all entries in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" /> have been marked as proposed to\par
\hskip\algorithmicindent or conflict with sections in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C_s}}" />\par
%this can be done because the student will be added back to free students if %they are kicked out and will get the opportunity to propose again
\hskip\algorithmicindent or <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%7CS_c%7C%20%5Cge%20L}}" />}
\State pop <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> from <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{freeStudents}}" />
\EndIf
\EndWhile
\State Add all current student section pairs to an <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S%2C%20C}}" /> matching <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{X}}" />
\State\Return <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{X}}" />
\EndProcedure
\end{algorithmic}
\end{algorithm}
\break

First, it can be proven that this algorithms will always return a stable matching in a case with no time conflicts between sections. Then it can be shown how this approach fails when time conflicts are introduced.\\

In a scenario with no time conflicts, students will "propose" to each course in their ranking in the order of the ranking with no exceptions. Assume towards contradiction that in this scenario, the algorithm produces a matching that includes a rogue pair and is therefore not pairwise-stable. Let an example of this pair be called (<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27}}" />) where <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c%27}}" /> includes a student <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cscore_%7Bs%27%2Cc%27%7D%20%3C%20%5Cscore_%7Bs%2Cc%27%7D}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{C_s}}" /> includes some course section <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> that is lower in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" /> than <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27}}" />.\\

Since <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> is in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> had to have "proposed" to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27}}" /> before proposing to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" />, and since <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27}}" /> is higher in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" /> than <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> must have either been rejected by <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27}}" /> initially or removed in favor of another student with a higher score. In the case of an initial rejection, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c%27}}" /> must have already been full of students with higher scores than <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" />. Since full course sections can only accept students with higher scores than some student that has already enrolled, it would be impossible for this condition to then change and impossible for <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%28s%2C%20c%27%29}}" /> to be a rogue pair. In the case of a removal of <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> from <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c%27}}" /> in favor of another student <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> must have been the lowest scoring student in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c%27}}" />. After being replaced, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> would have a lower score than any student in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_c%27}}" />. This is the same condition that occurs in the case of an initial rejection, and makes it impossible for <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%28s%2C%20c%27%29}}" /> to be a rogue pair.\\

Since a rogue pair is impossible if the student has already "proposed" to the course section, and the student must have already "proposed" to the course section, a rogue pair cannot be produced in a matching created by the algorithm on inputs without any time conflicts within students course selections.\\

Note that in this problems definition of rogue pair, an <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%28s%2C%20c%27%29}}" /> pair is not rogue if the student is matched with another course <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> where <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> is higher in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" /> than <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c%27}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Csched_c}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Csched_%7Bc%27%7D}}" /> have some overlap (time conflict).\\

Time conflicts introduce a new potential way for a rogue pair to arise in a matching. A student may not be enrolled in a course section due to time conflict, but may still prefer it to some other section they are enrolled in while scoring higher than some other student enrolled in said section.\\

One way for a rogue pair to arise in a scenario with time conflicts involves a student that has ranked conflicting courses, that do not all conflict. Consider some student <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> where <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" /> includes course sections <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{b}}" />, and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> in that order. <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{b}}" /> have conflicting schedules and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{b}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> have conflicting schedules, but <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> do not. <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> may initially be able to enroll in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a}}" />, which will stop <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> from proposing to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{b}}" />. Since there is no conflict between <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> can then enroll in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" />. If some student <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27}}" /> then proposes to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cscore_%7Ba%2Cs%27%7D%20%3E%20%5Cscore_%7Ba%2Cs%7D}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> will be removed from <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a}}" /> if it is at capacity. In this scenario <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> never gets the opportunity to propose to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{b}}" /> despite <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{b}}" /> being first in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%5Cranks_s}}" />. If <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{S_b}}" /> is populated with students that score lower than <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> for <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{b}}" />, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{%28s%2C%20b%29}}" /> will be a rogue pair. \\

\begin{figure}
  \centering
  \begin{tikzpicture}[scale=2] % Adjust the scale factor to make the graph larger
    % Nodes
    \node[circle, draw] (a) at (0,0) {<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a}}" />};
    \node[circle, draw] (b) at (2,0) {<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{b}}" />};
    \node[circle, draw] (c) at (4,0) {<img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" />};

    % Edges
    \draw (a) -- (b);
    \draw (b) -- (c);
  \end{tikzpicture}

  \begin{itemize}
  \item \(\ranks_{s}\): <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a%2C%20b%2C%20c}}" />
  \item \(\score_{a, s}\): 1
  \item \(\score_{a, s'}\): 2
  \end{itemize}
  
  \caption{The graph represents the case where scheduling conflicts can result in a rogue pair.}
  \label{fig:graph}
\end{figure}

The immediate thought for fixing the problems that may arise when this case exists while staying inside the Gale-Shapley framework is to have <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> propose to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{b}}" /> immediately after being removed from <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{a}}" />, and simply leave <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> if they are able to enroll. This would in fact eliminate the possibility of <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> from being in a rogue pair, however this approach creates a new issue. If <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> is to leave <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" />, some student <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27%27}}" /> may have already proposed to <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> and failed to enroll because the capacity was full and all students have a higher score. If no other student with a higher score than <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27%27}}" /> fills the new vacancy in <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> where <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s}}" /> was, <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{s%27%27}}" /> and <img src="https://render.githubusercontent.com/render/math?math=\bbox[%230d1117]{\color{white}{c}}" /> will be a rogue pair. This case makes it impossible to guarantee a stable matching from this algorithm.

\end{document}